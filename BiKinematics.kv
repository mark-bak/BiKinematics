#:kivy 1.11.1 

#general layout properties
#: set sidebar_width 420
#: set sidebar_coords_height 30
#: set topbar_height 50

<MainPage>:
#gonna make all these addable by code at some point
    GeoPoint:
        ref: 'Main_Piv'
        point_type: 'ground'
    GeoPoint:
        ref: 'Horst_Piv'
        point_type: 'joint'
    GeoPoint:
        ref: 'SStay_Piv'
        point_type: 'joint'
    GeoPoint:
        ref: 'Rocker_Piv'
        point_type: 'ground'
    GeoPoint:
        ref: 'Shock_Linkage'
        point_type: 'end_eff'
    GeoPoint:
        ref: 'Rear_Axle'
        point_type: 'end_eff'  
    GeoPoint:
        ref: 'Shock_Frame'
        point_type: 'ground'

    AnchorLayout: #Sidebar button anchor      
        anchor_x: "right"
        anchor_y: "bottom"
        
        BoxLayout:
            orientation: "vertical"
            size_hint_x: None
            width: sidebar_width
            size_hint_y: None
            height: root.height - topbar_height
            BoxLayout: #Sidebar button layout
                id: coords_list
                orientation: "vertical"
                size_hint_x: None
                width: sidebar_width
                canvas.after:
                    Color:
                        rgba: 1,1,1,1
                    Line:
                        points: [(self.x,self.y),(self.x,self.y+self.height)]
                #     Color:
                #         rgba: 1,0,0,0.5
                #     Rectangle:
                #         size: self.size
                #         pos: self.pos  
                BoxLayout:
                    orientation: 'horizontal'
                    size_hint_y:None
                    height: sidebar_coords_height
                    Label:
                        text: "Point"
                    Label:
                        text: "Type"
                    Label:
                        text: "x_pos"
                    Label:
                        text: "y_pos" 

            BoxLayout:
                id: links_list
                orientation: "vertical"
                size_hint_x: None
                width: sidebar_width
                canvas.after:
                    Color:
                        rgba: 1,1,1,1
                    Line:
                        points: [(self.x,self.y),(self.x,self.y+self.height)]
                    # Color:
                    #     rgba: 0,1,0,0.5
                    # Rectangle:
                    #     size: self.size
                    #     pos: self.pos  
                BoxLayout:
                    orientation: 'horizontal'
                    size_hint_y:None
                    height: sidebar_coords_height
                    Label:
                        text: "Link"
                    Label:
                        text: "Length"

    AnchorLayout: #Top button anchor      
        anchor_y: "top"
        anchor_x: "left"
        BoxLayout: #Topbar button layout
            size_hint_y: None
            height: topbar_height
            id: topbar
            orientation: "horizontal"
            # canvas.after:
            #     Color:
            #         rgba: 0,0,1,0.5
            #     Rectangle:
            #         size: self.size
            #         pos: self.pos  
            Button:
                text: 'Add Link'
                on_release: root.link_mode() 


<Coords>:
#Coordinate readout box
    orientation: "horizontal"
    size_hint_y:None
    height: sidebar_coords_height
    Label:
        text: root.ref
    Label:
        text: root.point_type
        on_touch_down: root.type_dropdown()
    TextInput:
        text: root.txt_x
    TextInput:
        text: root.txt_y

<LinkData>:
    #Coordinate readout box
    orientation: "horizontal"
    size_hint_y:None
    height: sidebar_coords_height
    Label:
        text: root.ref
    TextInput:
        text: root.len_txt

<GeoPoint>:
#Geometry point
    size_hint: None,None
    size: lbl.size
    canvas.after:
        Color:
            rgba: 0,1,0,0.5
        Rectangle:
            size: self.size
            pos: self.pos 
        Color:
            rgba: 1,0,0,1
        Ellipse:
            size: 5,5
            pos: self.pos[0]-2.5,self.pos[1]-2.5
    Label:
        id:lbl
        text: root.ref
        size: self.texture_size

<Link>:
    length: self.update_length()
    ref: self.a.ref+' - '+self.b.ref
    canvas:
        Line:
            points: self.points
<LoadDialog>:
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"
        FileChooserListView:
            id: filechooser
            path: root.get_dir()

        BoxLayout:
            size_hint_y: None
            height: 30
            Button:
                text: "Cancel"
                on_release: root.cancel()

            Button:
                text: "Load"
                on_release: root.load(filechooser.path, filechooser.selection)